<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corporate Attendance Tracker</title>
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Shadcn/ui via CDN (simplified for demo) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shadcn/ui/dist/styles.css">
    <!-- Framer Motion -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/framer-motion/11.10.6/framer-motion.min.js"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <!-- Date Picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <style>
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .toggle-bg:before {
            content: '';
            position: absolute;
            top: 0.125rem;
            left: 0.125rem;
            background: white;
            border-radius: 9999px;
            height: 1.25rem;
            width: 1.25rem;
            transition: transform 0.3s;
        }
        input:checked + .toggle-bg:before {
            transform: translateX(100%);
        }
        input:checked + .toggle-bg {
            background-color: #10B981;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        // React components with JSX
        const { useState, useEffect, useRef } = React;
        const { motion } = window["framer-motion"];

        // Sample employee data
        const initialEmployees = [
            { id: 1, name: 'Sarah Johnson', position: 'Marketing Manager', department: 'Marketing', avatar: 'SJ' },
            { id: 2, name: 'Michael Chen', position: 'Software Engineer', department: 'Engineering', avatar: 'MC' },
            { id: 3, name: 'Emily Rodriguez', position: 'HR Specialist', department: 'Human Resources', avatar: 'ER' },
            { id: 4, name: 'David Wilson', position: 'Financial Analyst', department: 'Finance', avatar: 'DW' },
            { id: 5, name: 'Jessica Thompson', position: 'Sales Executive', department: 'Sales', avatar: 'JT' },
            { id: 6, name: 'Robert Martinez', position: 'Product Designer', department: 'Design', avatar: 'RM' },
            { id: 7, name: 'Amanda Parker', position: 'Operations Manager', department: 'Operations', avatar: 'AP' },
            { id: 8, name: 'James Anderson', position: 'QA Engineer', department: 'Engineering', avatar: 'JA' }
        ];

        // Main App Component
        function App() {
            const [employees, setEmployees] = useState(initialEmployees);
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedDate, setSelectedDate] = useState(new Date());
            const [attendance, setAttendance] = useState({});
            const datePickerRef = useRef(null);

            // Initialize attendance data
            useEffect(() => {
                const dateStr = selectedDate.toISOString().split('T')[0];
                if (!attendance[dateStr]) {
                    const newAttendance = {...attendance};
                    newAttendance[dateStr] = {};
                    employees.forEach(emp => {
                        newAttendance[dateStr][emp.id] = false; // Default to absent
                    });
                    setAttendance(newAttendance);
                }
            }, [selectedDate, employees]);

            // Initialize date picker
            useEffect(() => {
                if (datePickerRef.current) {
                    flatpickr(datePickerRef.current, {
                        dateFormat: "M j, Y",
                        defaultDate: selectedDate,
                        onChange: ([date]) => setSelectedDate(date)
                    });
                }
            }, []);

            // Toggle attendance status
            const toggleAttendance = (empId) => {
                const dateStr = selectedDate.toISOString().split('T')[0];
                const newAttendance = {...attendance};
                newAttendance[dateStr][empId] = !newAttendance[dateStr][empId];
                setAttendance(newAttendance);
            };

            // Filter employees based on search term
            const filteredEmployees = employees.filter(emp => 
                emp.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                emp.department.toLowerCase().includes(searchTerm.toLowerCase())
            );

            // Export to CSV
            const exportToCSV = () => {
                const dateStr = selectedDate.toISOString().split('T')[0];
                const csvHeader = 'Employee ID,Name,Department,Position,Status,Date\n';
                const csvData = employees.map(emp => {
                    const status = attendance[dateStr] && attendance[dateStr][emp.id] ? 'Present' : 'Absent';
                    return `${emp.id},${emp.name},${emp.department},${emp.position},${status},${dateStr}`;
                }).join('\n');
                
                const blob = new Blob([csvHeader + csvData], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `attendance_${dateStr}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <header className="bg-white shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                            <div className="flex justify-between items-center">
                                <h1 className="text-2xl font-bold text-gray-900">Attendance Tracker</h1>
                                <div className="flex items-center space-x-4">
                                    <div className="relative">
                                        <input
                                            type="text"
                                            placeholder="Search employees..."
                                            className="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                        />
                                        <span className="absolute left-3 top-2.5 text-gray-400">
                                            {lucide.Search({size: 18})}
                                        </span>
                                    </div>
                                    <input
                                        ref={datePickerRef}
                                        type="text"
                                        className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="Select date"
                                    />
                                    <button
                                        onClick={exportToCSV}
                                        className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center"
                                    >
                                        {lucide.Download({size: 18, className: "mr-2"})}
                                        Export CSV
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {/* Stats Summary */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <motion.div 
                                initial={{ opacity: 0, y: 20 }}
                                animate={{ opacity: 1, y: 0 }}
                                transition={{ duration: 0.3 }}
                                className="bg-white rounded-xl shadow-sm p-6"
                            >
                                <div className="flex items-center">
                                    <div className="rounded-full bg-blue-100 p-3 mr-4">
                                        {lucide.Users({size: 24, className: "text-blue-600"})}
                                    </div>
                                    <div>
                                        <p className="text-sm font-medium text-gray-500">Total Employees</p>
                                        <p className="text-2xl font-bold text-gray-900">{employees.length}</p>
                                    </div>
                                </div>
                            </motion.div>
                            
                            <motion.div 
                                initial={{ opacity: 0, y: 20 }}
                                animate={{ opacity: 1, y: 0 }}
                                transition={{ duration: 0.3, delay: 0.1 }}
                                className="bg-white rounded-xl shadow-sm p-6"
                            >
                                <div className="flex items-center">
                                    <div className="rounded-full bg-green-100 p-3 mr-4">
                                        {lucide.CheckCircle({size: 24, className: "text-green-600"})}
                                    </div>
                                    <div>
                                        <p className="text-sm font-medium text-gray-500">Present Today</p>
                                        <p className="text-2xl font-bold text-gray-900">
                                            {selectedDate && attendance[selectedDate.toISOString().split('T')[0]] 
                                                ? Object.values(attendance[selectedDate.toISOString().split('T')[0]]).filter(Boolean).length
                                                : 0
                                            }
                                        </p>
                                    </div>
                                </div>
                            </motion.div>
                            
                            <motion.div 
                                initial={{ opacity: 0, y: 20 }}
                                animate={{ opacity: 1, y: 0 }}
                                transition={{ duration: 0.3, delay: 0.2 }}
                                className="bg-white rounded-xl shadow-sm p-6"
                            >
                                <div className="flex items-center">
                                    <div className="rounded-full bg-red-100 p-3 mr-4">
                                        {lucide.XCircle({size: 24, className: "text-red-600"})}
                                    </div>
                                    <div>
                                        <p className="text-sm font-medium text-gray-500">Absent Today</p>
                                        <p className="text-2xl font-bold text-gray-900">
                                            {selectedDate && attendance[selectedDate.toISOString().split('T')[0]] 
                                                ? Object.values(attendance[selectedDate.toISOString().split('T')[0]]).filter(status => !status).length
                                                : employees.length
                                            }
                                        </p>
                                    </div>
                                </div>
                            </motion.div>
                        </div>

                        {/* Employee Grid */}
                        <div className="bg-white rounded-xl shadow-sm overflow-hidden">
                            <div className="border-b border-gray-200 px-6 py-4">
                                <h2 className="text-lg font-medium text-gray-900">Employee Attendance</h2>
                                <p className="text-sm text-gray-500">
                                    {selectedDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                                </p>
                            </div>
                            
                            {filteredEmployees.length === 0 ? (
                                <div className="text-center py-12">
                                    <div className="text-gray-400 mb-4">{lucide.Search({size: 48, className: "mx-auto"})}</div>
                                    <p className="text-gray-500">No employees found matching your search.</p>
                                </div>
                            ) : (
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 p-6">
                                    {filteredEmployees.map((employee, index) => (
                                        <motion.div
                                            key={employee.id}
                                            initial={{ opacity: 0, scale: 0.9 }}
                                            animate={{ opacity: 1, scale: 1 }}
                                            transition={{ duration: 0.3, delay: index * 0.05 }}
                                            className="bg-white border border-gray-200 rounded-xl overflow-hidden card-hover"
                                        >
                                            <div className="p-6">
                                                <div className="flex items-center mb-4">
                                                    <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                                                        <span className="text-blue-800 font-semibold">{employee.avatar}</span>
                                                    </div>
                                                    <div>
                                                        <h3 className="font-medium text-gray-900">{employee.name}</h3>
                                                        <p className="text-sm text-gray-500">{employee.position}</p>
                                                    </div>
                                                </div>
                                                <div className="flex justify-between items-center mb-4">
                                                    <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                                        {employee.department}
                                                    </span>
                                                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                                        attendance[selectedDate.toISOString().split('T')[0]] && 
                                                        attendance[selectedDate.toISOString().split('T')[0]][employee.id]
                                                            ? 'bg-green-100 text-green-800'
                                                            : 'bg-red-100 text-red-800'
                                                    }`}>
                                                        {attendance[selectedDate.toISOString().split('T')[0]] && 
                                                         attendance[selectedDate.toISOString().split('T')[0]][employee.id]
                                                            ? 'Present'
                                                            : 'Absent'
                                                        }
                                                    </span>
                                                </div>
                                                <div className="flex justify-center mt-4">
                                                    <label className="flex items-center cursor-pointer">
                                                        <div className="relative">
                                                            <input 
                                                                type="checkbox" 
                                                                className="sr-only"
                                                                checked={attendance[selectedDate.toISOString().split('T')[0]] && 
                                                                         attendance[selectedDate.toISOString().split('T')[0]][employee.id]}
                                                                onChange={() => toggleAttendance(employee.id)}
                                                            />
                                                            <div className="block bg-gray-600 w-14 h-7 rounded-full toggle-bg"></div>
                                                        </div>
                                                    </label>
                                                </div>
                                            </div>
                                        </motion.div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="bg-white mt-12 py-6 border-t border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <p className="text-center text-gray-500">
                                &copy; {new Date().getFullYear()} Corporate Attendance Tracker. All rights reserved.
                            </p>
                        </div>
                    </footer>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
