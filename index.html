<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corporate Attendance Tracker</title>
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <!-- Flatpickr -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <style>
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .toggle-bg:before {
            content: '';
            position: absolute;
            top: 0.125rem;
            left: 0.125rem;
            background: white;
            border-radius: 9999px;
            height: 1.25rem;
            width: 1.25rem;
            transition: transform 0.3s;
        }
        input:checked + .toggle-bg:before {
            transform: translateX(100%);
        }
        input:checked + .toggle-bg {
            background-color: #10B981;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app" class="min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                    <h1 class="text-2xl font-bold text-gray-900">Attendance Tracker</h1>
                    <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto">
                        <div class="relative w-full md:w-64">
                            <input
                                type="text"
                                id="search-input"
                                placeholder="Search employees..."
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            />
                            <span class="absolute left-3 top-2.5 text-gray-400" id="search-icon">
                                <!-- Search icon will be inserted here -->
                            </span>
                        </div>
                        <div class="w-full md:w-auto">
                            <input
                                id="date-picker"
                                type="text"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Select date"
                            />
                        </div>
                        <button
                            id="export-btn"
                            class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center justify-center"
                        >
                            <!-- Download icon will be inserted here -->
                            <span class="ml-2">Export CSV</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Stats Summary -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6 slide-in" style="animation-delay: 0.1s;">
                    <div class="flex items-center">
                        <div class="rounded-full bg-blue-100 p-3 mr-4">
                            <span id="users-icon"></span>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-500">Total Employees</p>
                            <p class="text-2xl font-bold text-gray-900" id="total-employees">8</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 slide-in" style="animation-delay: 0.2s;">
                    <div class="flex items-center">
                        <div class="rounded-full bg-green-100 p-3 mr-4">
                            <span id="check-circle-icon"></span>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-500">Present Today</p>
                            <p class="text-2xl font-bold text-gray-900" id="present-count">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 slide-in" style="animation-delay: 0.3s;">
                    <div class="flex items-center">
                        <div class="rounded-full bg-red-100 p-3 mr-4">
                            <span id="x-circle-icon"></span>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-500">Absent Today</p>
                            <p class="text-2xl font-bold text-gray-900" id="absent-count">8</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Employee Grid -->
            <div class="bg-white rounded-xl shadow-sm overflow-hidden fade-in">
                <div class="border-b border-gray-200 px-6 py-4">
                    <h2 class="text-lg font-medium text-gray-900">Employee Attendance</h2>
                    <p class="text-sm text-gray-500" id="selected-date">
                        <!-- Date will be inserted here -->
                    </p>
                </div>
                
                <div id="employee-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 p-6">
                    <!-- Employee cards will be inserted here -->
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white mt-12 py-6 border-t border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <p class="text-center text-gray-500">
                    &copy; 2023 Corporate Attendance Tracker. All rights reserved.
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Sample employee data
        const employees = [
            { id: 1, name: 'Sarah Johnson', position: 'Marketing Manager', department: 'Marketing', avatar: 'SJ' },
            { id: 2, name: 'Michael Chen', position: 'Software Engineer', department: 'Engineering', avatar: 'MC' },
            { id: 3, name: 'Emily Rodriguez', position: 'HR Specialist', department: 'Human Resources', avatar: 'ER' },
            { id: 4, name: 'David Wilson', position: 'Financial Analyst', department: 'Finance', avatar: 'DW' },
            { id: 5, name: 'Jessica Thompson', position: 'Sales Executive', department: 'Sales', avatar: 'JT' },
            { id: 6, name: 'Robert Martinez', position: 'Product Designer', department: 'Design', avatar: 'RM' },
            { id: 7, name: 'Amanda Parker', position: 'Operations Manager', department: 'Operations', avatar: 'AP' },
            { id: 8, name: 'James Anderson', position: 'QA Engineer', department: 'Engineering', avatar: 'JA' }
        ];

        // Initialize attendance data structure
        let attendanceData = {};
        let currentDate = new Date();
        let filteredEmployees = [...employees];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize icons
            document.getElementById('search-icon').appendChild(lucide.Search({size: 18}));
            document.getElementById('users-icon').appendChild(lucide.Users({size: 24, class: "text-blue-600"}));
            document.getElementById('check-circle-icon').appendChild(lucide.CheckCircle({size: 24, class: "text-green-600"}));
            document.getElementById('x-circle-icon').appendChild(lucide.XCircle({size: 24, class: "text-red-600"}));
            
            const exportBtn = document.getElementById('export-btn');
            exportBtn.insertBefore(lucide.Download({size: 18}), exportBtn.firstChild);
            
            // Initialize date picker
            const datePicker = flatpickr("#date-picker", {
                dateFormat: "M j, Y",
                defaultDate: currentDate,
                onChange: function(selectedDates, dateStr) {
                    currentDate = selectedDates[0];
                    updateSelectedDateDisplay();
                    loadAttendanceData();
                    renderEmployeeCards();
                    updateStats();
                }
            });
            
            // Set up search functionality
            document.getElementById('search-input').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                filteredEmployees = employees.filter(emp => 
                    emp.name.toLowerCase().includes(searchTerm) ||
                    emp.department.toLowerCase().includes(searchTerm) ||
                    emp.position.toLowerCase().includes(searchTerm)
                );
                renderEmployeeCards();
            });
            
            // Set up export functionality
            document.getElementById('export-btn').addEventListener('click', exportToCSV);
            
            // Initialize the app
            updateSelectedDateDisplay();
            loadAttendanceData();
            renderEmployeeCards();
            updateStats();
        });

        // Update the displayed selected date
        function updateSelectedDateDisplay() {
            const dateElement = document.getElementById('selected-date');
            dateElement.textContent = currentDate.toLocaleDateString('en-US', { 
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
            });
        }

        // Load attendance data from localStorage or initialize
        function loadAttendanceData() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const storedData = localStorage.getItem('attendanceData');
            
            if (storedData) {
                attendanceData = JSON.parse(storedData);
                
                // Initialize for current date if not exists
                if (!attendanceData[dateStr]) {
                    attendanceData[dateStr] = {};
                    employees.forEach(emp => {
                        attendanceData[dateStr][emp.id] = false; // Default to absent
                    });
                }
            } else {
                // Initialize fresh data structure
                attendanceData[dateStr] = {};
                employees.forEach(emp => {
                    attendanceData[dateStr][emp.id] = false; // Default to absent
                });
            }
            
            // Save back to localStorage
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
        }

        // Render employee cards
        function renderEmployeeCards() {
            const grid = document.getElementById('employee-grid');
            grid.innerHTML = '';
            
            const dateStr = currentDate.toISOString().split('T')[0];
            
            if (filteredEmployees.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-gray-400 mb-4">${lucide.Search({size: 48, class: "mx-auto"}).outerHTML}</div>
                        <p class="text-gray-500">No employees found matching your search.</p>
                    </div>
                `;
                return;
            }
            
            filteredEmployees.forEach((employee, index) => {
                const isPresent = attendanceData[dateStr] && attendanceData[dateStr][employee.id];
                const statusClass = isPresent ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
                const statusText = isPresent ? 'Present' : 'Absent';
                
                const card = document.createElement('div');
                card.className = `bg-white border border-gray-200 rounded-xl overflow-hidden card-hover fade-in`;
                card.style.animationDelay = `${index * 0.05}s`;
                card.innerHTML = `
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                                <span class="text-blue-800 font-semibold">${employee.avatar}</span>
                            </div>
                            <div>
                                <h3 class="font-medium text-gray-900">${employee.name}</h3>
                                <p class="text-sm text-gray-500">${employee.position}</p>
                            </div>
                        </div>
                        <div class="flex justify-between items-center mb-4">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                ${employee.department}
                            </span>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusClass}">
                                ${statusText}
                            </span>
                        </div>
                        <div class="flex justify-center mt-4">
                            <label class="flex items-center cursor-pointer">
                                <div class="relative">
                                    <input 
                                        type="checkbox" 
                                        class="sr-only" 
                                        ${isPresent ? 'checked' : ''}
                                        onchange="toggleAttendance(${employee.id})"
                                    />
                                    <div class="block bg-gray-600 w-14 h-7 rounded-full toggle-bg"></div>
                                </div>
                            </label>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Toggle attendance status
        function toggleAttendance(empId) {
            const dateStr = currentDate.toISOString().split('T')[0];
            attendanceData[dateStr][empId] = !attendanceData[dateStr][empId];
            
            // Save to localStorage
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            
            // Update UI
            renderEmployeeCards();
            updateStats();
        }

        // Update statistics
        function updateStats() {
            const dateStr = currentDate.toISOString().split('T')[0];
            let presentCount = 0;
            
            if (attendanceData[dateStr]) {
                presentCount = Object.values(attendanceData[dateStr]).filter(status => status).length;
            }
            
            document.getElementById('total-employees').textContent = employees.length;
            document.getElementById('present-count').textContent = presentCount;
            document.getElementById('absent-count').textContent = employees.length - presentCount;
        }

        // Export to CSV
        function exportToCSV() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const csvHeader = 'Employee ID,Name,Department,Position,Status,Date\n';
            
            const csvData = employees.map(emp => {
                const status = attendanceData[dateStr] && attendanceData[dateStr][emp.id] ? 'Present' : 'Absent';
                return `${emp.id},${emp.name},${emp.department},${emp.position},${status},${dateStr}`;
            }).join('\n');
            
            const blob = new Blob([csvHeader + csvData], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `attendance_${dateStr}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
